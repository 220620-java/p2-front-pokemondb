<html>
    <head>
        <!-- metadata -->
        <title>PokePost Pokemon Search</title>
        <meta charset="UTF-8">
		<link rel= "icon" href="images/pokeball.png" type="image/x-icon">
		<link rel="stylesheet" href="css/mainPokePost.css">
		<link rel="stylesheet" href="css/pokemonPage.css">
		<link rel="stylesheet" href="css/navbar.css" type="text/css">
		<link rel="stylesheet" href="comments/comment.css">
		<!-- Progress Circle-->
		<!-- <link rel="stylesheet" href="css/progresscircle.css" /> -->
		<!-- <script src="js/progresscircle.js"></script> -->
		<script src="js/commentSection.js" defer></script>

		<script type="module">
			import { getRequest } from "./js/getRequest.js";
			window.getRequest = getRequest;
		</script>
		<script type="module">
			import { createPokemonPage } from "./js/createPokemonPage.js";
			window.createPokemonPage = createPokemonPage;
		</script>
    </head>
    <body>
		<!-- Nav bar -->
		<nav>
			<div id="menuBar">
				<ul id="nav">
					<li><a href="index.html"><img class="navImg" src="images/Home.png"></a></li>
					<li><a href="pokemonPage.html"><img class="navImg" src="images/Pokemon.png"></a></li>
					<li><a href="location.html"><img class="navImg" src="images/Locations.png"></a></li>
					<li><a href="fanartUnq.html"><img class="navImg" src="images/Fanart.png"></a></li>
					<li><a href="wishlist.html"><img class="navImg" src="images/Wishlist.png"></a></li>
				</ul>
				<li id="loginLink"><a  href="login.html"><img class="navImg" src="images/log-in.png"></a></li>
			</div>
		</nav>
		<div class="grid">
			<!-- Row 1 Header -->
			<aside class="aside-left">
			</aside>
			<section>
				<div><h1 style="text-align: center">Pokémon Page</h1></div>
			</section>
			<aside class="aside-right">
			</aside>
			<!-- Row 2 Search Bar -->
			<aside class="aside-left">
			</aside>
			<section>
				<div class=pokemonClass>
					<form class=pokemonClass onsubmit="return sendPokemonRequest(); return false">
						<p>Enter a Pokémon name or ID:</p>
						<input value="Pikachu" type="text" id="pokemon_box">
						<button id="button" type="button" class="btn btn-primary" onclick="return sendPokemonRequest()">Get Pokemon</button>
					</form>
				</div>
			</section>
			<aside class="aside-right">
			</aside>
			<!-- Row 3 Pokemon Content -->
			<aside class="aside-left">
			</aside>
			<section style="max-width: 100%">
				<div id="pokemon_output">
					<h1>Text</h1>
					<img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/363.png">
				</div>
				<div class="container">
					<label for="newComment" name="newComment">Add your comment below-</label>
					<textarea id="newComment"></textarea>
					<button id="addComments">Add Comment</button>
					<!----<script>
						const commentContainer = document.getElementById('allComments');
						document.getElementById('addComments').addEventListener('click', function (ev) {
						addComment(ev);
						});
						let commentId = 0;
						async function addComment(ev) {
							let url = "http://localhost:8080/pokemon-comment";
							fetch(url)

							let commentText;
							let username = pastComments.username;
							const textBox = document.createElement('div');
							const userbox= document.createElement('div');
							const likeButton = document.createElement('button');
							likeButton.innerHTML = 'Like';
							likeButton.className = 'likeComment';
							const deleteButton = document.createElement('button');
							deleteButton.innerHTML = 'Delete';
							deleteButton.className = 'deleteComment';
							const wrapDiv = document.createElement('div');
							wrapDiv.className = pastComments.id;
							wrapDiv.style.marginLeft = 0;
							commentText = document.getElementById('newComment').value;
							document.getElementById('newComment').value = '';
							textBox.innerHTML = commentText;
							textBox.style.padding = 3;
							userbox.innerHTML = username;
							userbox.style.borderBottom = 3;
							userbox.style.borderBottom = "#fff solid 3px";
							userbox.style.padding = 3;
							wrapDiv.append(userbox, textBox, likeButton, deleteButton);

							let jsonContent = {
							//	"pokemonId": 
							};
							
							commentContainer.appendChild(wrapDiv);
							fetch(url, {
								method: "POST",
								headers: {
									"Content-Type": "application/json"
								},
								body: jsonContent,
								credentials:"omit"
							}).then(function(response) {
									response.status
									return response.text()
								}, function(error) {
									error.message
							});
						}
					</script>-->
				</div>
			</section>
			<aside class="aside-right">
			</aside>
		</div>
    </body>
    <script>
		// Send the pokemon get request
		function sendPokemonRequest() {
			let pokemon_name = document.getElementById('pokemon_box').value;
			console.log ("Sending Pokemon Request... " + pokemon_name);
		
			//checks username and password for empty credentials
			if (pokemon_name == "") {
				alert("Invalid Credentials: Please Fill Out All Inputs");
				return false;
			}
		
			// Send username and password to the backend to check against values in the DB
			let url = "http://pokepost-env.eba-jzp4ndpr.us-east-1.elasticbeanstalk.com/pokemon/" + pokemon_name;
			//let url = "http://localhost:8080/pokemon/" + pokemon_name;
			getRequest (url, createPokemonPage, onHeadersReceived, onLoading);

			return false;
		}

		function onHeadersReceived () {
			let pokemon_name = document.getElementById('pokemon_box').value;
			const outputDiv = document.getElementById ("pokemon_output");
			outputDiv.innerHTML = "";
			const titleLine = document.createElement("h1");
			const titleText = document.createTextNode("Looking for a " + pokemon_name);
			titleLine.appendChild (titleText);
			outputDiv.appendChild (titleLine);
		}

		function onLoading () {
			let pokemon_name = document.getElementById('pokemon_box').value;
			const outputDiv = document.getElementById ("pokemon_output");
			outputDiv.innerHTML = "";
			const titleLine = document.createElement("h1");
			const titleText = document.createTextNode("Found a " + pokemon_name + "!");
			titleLine.appendChild (titleText);
			outputDiv.appendChild (titleLine);
		}
	</script>
</html>